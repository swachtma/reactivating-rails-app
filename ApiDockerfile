FROM ruby:2.5.1

WORKDIR /root

# Install cmake for a gemfile dependency
RUN apt-get update && \
apt-get install -y cmake && \
gem install rails -v 5.2.0 && \
rails new /api_cache --api --database=postgresql --skip-bundle --skip-git

WORKDIR /root/api

COPY ./api-entry.sh /api-entry.sh
ENTRYPOINT [ "/api-entry.sh" ]
CMD ["bash"]