FROM node:8

# Create a local copy of a CRA app in the container.  This ensure each created container
# will use the same version of CRA and more specifically, react-scripts.
RUN npx create-react-app /app_lock/rr_client
RUN rm -rf /app_lock/rr_client/node_modules

# Overwrite stored package.json file with docker settings 
COPY ./.docker/init_package.json /app_lock/rr_client/package.json

# Set working directory to Client root, so bash CMD override starts in client context.
WORKDIR /root/client

# Copy startup script to container root and set as entrypoint
COPY ./.docker/client-entry.sh /client-entry.sh
RUN chmod +x /client-entry.sh
ENTRYPOINT [ "/client-entry.sh" ]

CMD ["bash"]